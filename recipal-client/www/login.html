<!DOCTYPE html>
<meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'"/>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" href="css/onsen/onsenui.css">
        <link rel="stylesheet" href="css/onsen/onsen-css-components.css">
        <script src="js/onsen/angular/angular.js"></script>
        <script src="js/onsen/onsenui.js"></script>
        <script>
            ons.bootstrap();
            ons.ready(function() {
            // Add another Onsen UI element
            var content = document.getElementById("my-content");
            menu.openMenu();
            ons.compile(content);
        });
        </script>
        <title>Welcome To Recipal!</title>
    </head>
    <body>
	
	<!-- Page Navigator and create sliding menu -->
	<ons-navigator title="Navigator" var="myNavigator">
	 <ons-sliding-menu main-page="login.html" menu-page="menu.html" max-slide-distance="310px" type="push" var="menu">
    </ons-sliding-menu>
	
	<!-- Login Page -->
	<ons-template id="login.html">
	  <ons-page>
	    <ons-toolbar>
		  <div class="left">
		    <ons-toolbar-button onclick="menu.toggleMenu()">
			<ons-icon icon="ion-navicon" size="28px" fixed-width="false"></ons-icon>
			</ons-toolbar-button>
		  </div>
		  <div class="center">Login & Sign Up</div>
		</ons-toolbar>
			<!--LOGIN PAGE CONTENTS-->
		<div class="login-form">
			<input type="email" id="login-user" class="text-input--underbar" placeholder="Username" value="">
			<input type="password" id="login-pass" class="text-input--underbar" placeholder="Password" value="">
			<br><br>
			<ons-button modifier="large" class="login-button" onclick="login()">Log In</ons-button>
				<script>
					function login() {
						// Username value
						var user = document.getElementById("login-user").value;
						// Password value
						var pass = document.getElementById("login-pass").value;
						//alert("username: " + user + "\npassword: "  + pass);
						//	TODO: Actual log in function.
						server.login(user, pass, function(success, data) {
							if (success === true) console.log(data)});
					}
				</script>
			<br><br>
			<ons-button modifier="quiet" onclick="myNavigator.pushPage('signup.html')">Sign Up!</ons-button><br>
			<ons-button modifier="quiet" onclick="myNavigator.pushPage('forgotpass.html')">Forgot password?</ons-button>
		</div>
	  </ons-page>
	</ons-template>
	
	<!-- Sign Up Page -->
	<ons-template id="signup.html">
	  <ons-page>
	    <ons-toolbar>
		  <div class="left">
		    <ons-toolbar-button onclick="menu.toggleMenu()">
				<ons-icon icon="ion-navicon" size="28px" fixed-width="false"></ons-icon>
			</ons-toolbar-button>
		  </div>
		  <div class="center">Sign Up</div>
		</ons-toolbar>
			<div class="login-form">
				<input type="email" id="signup-user" class="text-input--underbar" placeholder="Username" value="">
				<input type="password" id="signup-pass" class="text-input--underbar" placeholder="Password" value="">
				<input type="email" id="signup-email" class="text-input--underbar" placeholder="Email" value="">
				<br><br>
				<ons-button modifier="large" class="login-button" onclick="signup()">Sign Up</ons-button><br>
				<div align="right">
				<ons-button modifier="quiet" onclick="myNavigator.popPage()">Back</ons-button>
				</div>
					<script>
						function signup() {
							// Username value
							var suuser = document.getElementById("signup-user").value;
							// Password value
							var supass = document.getElementById("signup-pass").value;
							// Email value
							var suemail = document.getElementById("signup-email").value;
							//alert("username: " + suuser + "\npassword: "  + supass + "\nemail: " + suemail);
							//	TODO: Actual sign up function.
							// Just add user information to database?
							server.createAccount("tam" + Math.random(), suuser, supass, suemail, 
								function(success, data) {
									if (success === true) console.log(data)});
						}
					</script>
			</div>
	   </ons-page>
	</ons-template>
	
	<!-- Forgot Password Page -->
	<ons-template id="forgotpass.html">
	  <ons-page>
	    <ons-toolbar>
		  <div class="left">
		    <ons-toolbar-button onclick="menu.toggleMenu()">
			<ons-icon icon="ion-navicon" size="28px" fixed-width="false"></ons-icon>
			</ons-toolbar-button>
		  </div>
		  <div class="center">Forgotten Password</div>
		</ons-toolbar>
			<div class="login-form">
				What is your email?<br><br>
				<input type="email" id="fpuser" class="text-input--underbar" placeholder="Email" value="" onkeypress="return emailpass(event)"/><br><br>
				<div align="right">
				<ons-button modifier="quiet" onclick="myNavigator.popPage()">Back</ons-button>
				</div>
				<script>
				 function emailpass(e) {
					if (e.keyCode === 13) {
						// User's email value
						var fpuser = document.getElementById("fpuser").value;
						alert("Email: " + fpuser);
						// TODO: Email user their password after they enter their email.
						// TODO: Check if email is in the database, if not display error.
					} else {
					// Do nothing.
					}
				}
				</script>
				
			</div>
	  </ons-page>
	</ons-template>
	
	<!-- Put together the sliding menu -->
    <ons-template id="menu.html">
      <ons-page modifier="menu-page">
        <ons-toolbar modifier="transparent">
          <div class="right">
            <ons-toolbar-button class="menu-close" ng-click="menu.close()">
              </ons-icon>Close
            </ons-toolbar-button>
          </div>
        </ons-toolbar>

        <ons-list class="menu-list">
          <ons-list-item modifier="chevron" class="menu-item" onclick="callLoginPage()">
			<script>
				function callLoginPage() {
					window.location = "login.html";
				}
			</script>
            Login & Sign Up
          </ons-list-item>

          <ons-list-item modifier="chevron" class="menu-item" onclick="callSearchPage()">
			<script>
				function callSearchPage() {
					window.location = "search.html";
				}
			</script>
            Search
          </ons-list-item>
		  
		  <ons-list-item modifier="chevron" class="menu-item" onclick="callBrowsePage()">
			<script>
				function callBrowsePage() {
					window.location = "browse.html";
				}
			</script>
            Browse
          </ons-list-item>

          <ons-list-item modifier="chevron" class="menu-item" onclick="callFavouritesPage()">
			<script>
				function callFavouritesPage() {
					window.location = "favourites.html";
				}
			</script>
            Favourites
          </ons-list-item>
        </ons-list>

        <br>

        <ons-list class="bottom-menu-list">
          <ons-list-item class="bottom-menu-item" onclick="callAccountsPage()">
			<script>
				function callAccountsPage() {
					window.location = "accounts.html";
				}
			</script>
            Account & Settings
            <!-- <div class="notification menu-notification">3</div> -->
          </ons-list-item>

      </ons-page>
    </ons-template>

    <script src="cordova.js"></script>
    <script src="js/socket.io-1.3.7.js"></script>
    <script src="js/jquery-compat-3.0.0-alpha1.js"></script>
    <script src="js/onsen/onsenui.js"></script>
    <script src="js/models.js"></script>
    <script src="js/server-proxy.js"></script>
    <script src="js/proximity-sensor.js"></script>
    <script src="js/index.js"></script>
    <script>
    server.connect(function() {
    	server.searchRecipes(
    		new Query("", "name3", {min: 2, max: 4}, {min: 1, max: 5}, ["bread"], ["breakfast"]), 
    		function(recipeArr) {
    			console.log(recipeArr);});
    });
    </script>
    <script>app.initialize();</script>
</body>
</html>
